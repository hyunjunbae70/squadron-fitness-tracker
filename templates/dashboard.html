{% extends "base.html" %}
{% block content %}
<div class="container py-5">
  <div class="row g-4">
    <div class="col-lg-5">
      <div class="card shadow-sm">
        <div class="card-body">
          <h4 class="card-title">Log a Workout</h4>
          <form method="POST" action="{{ url_for('log_workout') }}" novalidate>
            <div class="mb-3">
              <label class="form-label">Exercise Type *</label>
              <input type="text" name="exercise_type" class="form-control" placeholder="Running, push-ups, etc." required>
            </div>
            <div class="mb-3">
              <label class="form-label">Date</label>
              <input type="date" name="date" class="form-control">
            </div>
            <div class="mb-3">
              <label class="form-label">Duration (minutes)</label>
              <input type="number" name="duration" class="form-control" min="0">
            </div>
            <div class="mb-3">
              <label class="form-label">Distance (miles)</label>
              <input type="number" step="0.01" name="distance" class="form-control" min="0">
            </div>
            <div class="mb-3">
              <label class="form-label">Reps</label>
              <input type="number" name="reps" class="form-control" min="0">
            </div>
            <div class="mb-3">
              <label class="form-label">Weight (lbs)</label>
              <input type="number" step="0.5" name="weight" class="form-control" min="0">
            </div>
            <button class="btn btn-primary w-100" type="submit">Save Workout</button>
          </form>
        </div>
      </div>
    </div>

    <div class="col-lg-7">
      <div class="card shadow-sm h-100">
        <div class="card-body">
          <h4 class="card-title">Recent Workouts</h4>
          {% if recent_workouts %}
            <div class="list-group list-group-flush">
              {% for w in recent_workouts %}
                <div class="list-group-item">
                  <div class="d-flex justify-content-between">
                    <strong>{{ w['exercise_type'] }}</strong>
                    <small class="text-muted">{{ w['date'] }}</small>
                  </div>
                  <div class="small text-muted">
                    {% if w['duration'] %}Duration: {{ w['duration'] }} min{% endif %}
                    {% if w['distance'] %} | Distance: {{ w['distance'] }} mi{% endif %}
                    {% if w['reps'] %} | Reps: {{ w['reps'] }}{% endif %}
                    {% if w['weight'] %} | Weight: {{ w['weight'] }} lbs{% endif %}
                  </div>
                </div>
              {% endfor %}
            </div>
          {% else %}
            <p class="text-muted mt-3">No workouts logged yet. Log one to get started!</p>
          {% endif %}
        </div>
      </div>
    </div>
  </div>

  <div class="row g-4 mt-1">
    <div class="col-lg-6">
      <div class="card shadow-sm">
        <div class="card-body">
          <h4 class="card-title">Workouts This Week</h4>
          <div class="chart-container">
            <canvas id="workoutsByDayChart"></canvas>
          </div>
        </div>
      </div>
    </div>
    <div class="col-lg-6">
      <div class="card shadow-sm">
        <div class="card-body">
          <h4 class="card-title">Workouts by Type</h4>
          <div class="chart-container">
            <canvas id="workoutsByTypeChart"></canvas>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>

<script>
  window.dashboardChartData = {
    weekLabels: {{ chart_week_labels|default([])|tojson }},
    weekValues: {{ chart_week_values|default([])|tojson }},
    typeLabels: {{ chart_type_labels|default([])|tojson }},
    typeValues: {{ chart_type_values|default([])|tojson }},
  };
</script>
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<script src="{{ url_for('static', filename='js/charts.js') }}"></script>
{% endblock %}
